<h2>ショッピングカート</h2>
<div>
  <%= link_to "カートを空にする", cart_items_path, method: :delete, class: "btn btn-sm btn-danger", data: { confirm: 'are you sure?' } %>
</div>
<table>
  <tread>
    <tr>
      <td>商品名</td>
      <td>単価(税込)</td>
      <td>数量</td>
      <td>小計</td>
      <td></td>
    </tr>
  </tread>
  <tbody>
    <% @cart_items.each do |cart_item| %>
      <tr>
        <td>
          <%= attachment_image_tag cart_item.item, :image, size: "50x50", format: 'jpeg' %>
          <%= cart_item.item.name %>
        </td>
        <td><%= (cart_item.item.price * 1.1).floor %></td>
        <td>
          <!--update　form_withで囲う-->
          <%= form_with model: cart_item, local:true do |f| %>
            <%= f.number_field :amount, min:1 %>
            <%= f.submit "変更" %>
          <% end %>
        </td>
        <td><%= (cart_item.item.price * cart_item.amount * 1.1).floor %></td>
        <td><%= link_to "削除", cart_item_path(cart_item), method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>
<div>
  <%= link_to "買い物を続ける", items_path %>
</div>
<div>
  <div>
    合計金額
  </div>
  <div>
    <%= @total_price %>
  </div>
</div>